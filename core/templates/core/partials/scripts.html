<script>

    /*TOP*/
    var swiper = new Swiper(".mySwiper", {
        autoplay: {
            delay: 5000,
            disableOnInteraction: false,
        },
    });

    let lastScroll = 0;
    const nav = document.querySelector('.navbar');
    const nav2 = document.querySelector('.buscador');
    const Top = document.getElementById('Top');
    nscrollup = 0
    nscrollupuntil = 60

    window.addEventListener('scroll',() => {

        currentScroll = window.pageYOffset
        
        if ((currentScroll < lastScroll && nav.classList.contains('scroll-down') && (nscrollup == nscrollupuntil)) || (currentScroll < 170))  {
            nav.classList.add('scroll-up');
            nav.classList.remove('scroll-down');
        }

        if (currentScroll > lastScroll && nav.classList.contains('scroll-up') && (currentScroll > 170) ) {
            nav.classList.remove('scroll-up');
            nav.classList.add('scroll-down');
        }

        if ((currentScroll < lastScroll && nav2.classList.contains('scroll-down-busca') && (nscrollup == nscrollupuntil)) || (currentScroll < 170)) {
            nav2.classList.add('scroll-up-busca');
            nav2.classList.remove('scroll-down-busca');
        }

        if (currentScroll > lastScroll && nav2.classList.contains('scroll-up-busca') && (currentScroll > 170)) {
            nav2.classList.remove('scroll-up-busca');
            nav2.classList.add('scroll-down-busca');
        }

        if(lastScroll > currentScroll && (currentScroll > 170)){
            nscrollup = nscrollup + 1;
        }else{
            nscrollup = 0;
        }
        if(nscrollup == nscrollupuntil + 1){nscrollup = 0;}

        lastScroll = currentScroll;

    })

    const div = document.querySelector('.menu-mobile');
    const div2 = document.querySelector('.menu-mobile-l');

    function menu_mobile(){

        if (div.classList.contains('invisible')){
            div.classList.remove('invisible');
            div.classList.add('visible');

            div2.style.animation ="sidebar-open 500ms 1"

        }else{
            div2.style.animation ="sidebar-close 500ms 1"
            
            div.classList.remove('visible');
            div.classList.add('invisible');
        }
   }

   /*SHOP queryString = `category=${param1}&price=${param2}`             ?category={{ category.slug }}*/
   const url = window.location.href.split('?')[0];
   const urlParams = new URLSearchParams(window.location.search);
   let param1 = urlParams.get('category');
   let param2 = urlParams.get('price');

   const rangeInput = document.querySelectorAll('.range-input input');
   const rangePrices = document.getElementById('range-prices');
   let priceGap = 0;

   rangeInput.forEach(input =>{
        if(param2){
            rangeInput[0].value = param2.split(',')[0]
            rangeInput[1].value = param2.split(',')[1]
            if(rangeInput[1].value - rangeInput[0].value < priceGap) {
                if(input.id === 'rangemin'){
                    rangeInput[0].value = rangeInput[1].value - priceGap;
                }else{
                    rangeInput[1].value = rangeInput[0].value + priceGap;
                }
            }
            rangePrices.innerHTML = `<div class="">${rangeInput[0].value},00€ - ${rangeInput[1].value},00€</div>`;
        }

        input.addEventListener('input', e =>{
            let minVal = parseInt(rangeInput[0].value);
            maxVal = parseInt(rangeInput[1].value);
           
            if(maxVal - minVal < priceGap) {
                if(e.target.id === 'rangemin'){
                    rangeInput[0].value = maxVal - priceGap;
                }else{
                    rangeInput[1].value = minVal + priceGap;
                }
            }
            minVal = rangeInput[0].value;
            maxVal = rangeInput[1].value;

            rangePrices.innerHTML = `<div class="">${minVal},00€ - ${maxVal},00€</div>`;
            
        });
        
        input.addEventListener('mouseup', () =>{
            let min_price = parseInt(rangeInput[0].value);
            let max_price = parseInt(rangeInput[1].value);
            param2 = `${min_price},${max_price}`;

            if(param1){
                window.location.href = url + '?' + `category=${param1}&price=${param2}`;
            }else{
                window.location.href = url + '?' + `price=${param2}`
            }
        });
   });
   </script>